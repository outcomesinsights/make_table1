% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/table1_word_doc.R
\name{implement_table1}
\alias{implement_table1}
\title{Add Table 1 to Word Document}
\usage{
implement_table1(
  doc,
  table1_result = NULL,
  caption = NULL,
  caption_style = "caption",
  data = NULL,
  vars = NULL,
  subgroups = NULL,
  section_prefix = "Tables for",
  caption_prefix = "Table 1:  Population Characteristics for",
  caption_suffix = " Patients",
  section_style = "heading 1",
  add_page_breaks = TRUE,
  first_table_pos = "after",
  digits = 1,
  ...
)
}
\arguments{
\item{doc}{An \code{officer} document object.}

\item{table1_result}{Output from \code{\link{specify_table1}}. Ignored if
\code{data}, \code{vars}, and \code{subgroups} are provided.}

\item{caption}{Character string, optional table caption. For individual
tables, this is used as a prefix with subgroup name appended.}

\item{caption_style}{Character string, style for the caption. Default: "caption".}

\item{data}{Data frame containing the data. If provided along with \code{vars}
and \code{subgroups}, individual tables are created for each subgroup.}

\item{vars}{Variable specification (as used in \code{\link{specify_table1}}).}

\item{subgroups}{Named list of filter functions for creating individual tables.}

\item{section_prefix}{Character string prefix for section headings when
creating individual tables. Default: "Tables for".}

\item{caption_prefix}{Character string prefix for table captions when
creating individual tables. Default: "Table 1:  Population Characteristics for".}

\item{caption_suffix}{Character string suffix for table captions when
creating individual tables. Default: " Patients".}

\item{section_style}{Character string, paragraph style for section headings.
Default: "heading 1".}

\item{add_page_breaks}{Logical, whether to add page breaks between individual
tables. Default: TRUE.}

\item{first_table_pos}{Character string, position for first table section heading.
Options: "before" or "after" (default).}

\item{digits}{Numeric, number of decimal places for summary statistics when
creating individual tables. Default: 1.}

\item{...}{Additional arguments passed to \code{\link{table1_to_flextable}}.}
}
\value{
The modified \code{officer} document object.
}
\description{
Converts a Table 1 result to a flextable and adds it to a Word document,
optionally with a caption. If \code{data}, \code{vars}, and \code{subgroups}
are provided, automatically creates individual tables for each subgroup
instead of using \code{table1_result}.
}
\details{
If \code{data}, \code{vars}, and \code{subgroups} are all provided, this
function automatically creates individual Table 1 tables for each subgroup
by filtering the data and adding them to the document with section headings,
captions, and page breaks. Otherwise, it adds the \code{table1_result} as-is.
}
\examples{
\dontrun{
# Single table
table1 <- specify_table1(data, vars = c("age", "sex"))
doc <- table1_word_doc() |>
  implement_table1(table1, caption = "Table 1: Patient Characteristics")

# Individual tables for each subgroup (automatic)
doc <- table1_word_doc() |>
  implement_table1(
    data = dt_prep,
    vars = varlist,
    subgroups = list(
      "All Diagnosed" = function(d) rep(TRUE, nrow(d)),
      "No Treatment" = function(d) d$treatment == "None"
    ),
    footer_text = "Note: Results presented as \% (count)..."
  )
}

}
