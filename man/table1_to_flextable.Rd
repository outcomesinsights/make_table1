% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/table1_to_flextable.R
\name{table1_to_flextable}
\alias{table1_to_flextable}
\title{Convert Table 1 to flextable for Word Export}
\usage{
table1_to_flextable(
  table1_result,
  show_n_column = NULL,
  header_n_format = "(n={n})",
  cell_n_format = ", n={n}",
  indent_width = 2,
  multiline_header = FALSE,
  format_description = "\% (N) or Mean (SD)",
  footer_text = NULL,
  table_width = 1,
  table_layout = "autofit",
  theme = "vanilla",
  format_line_fontsize = 9,
  merge_variable_header = NULL,
  bold_header = TRUE,
  bold_variable_column = FALSE,
  bold_subheaders = TRUE,
  ...
)
}
\arguments{
\item{table1_result}{Output from \code{\link{specify_table1}}}

\item{show_n_column}{Logical, whether to show n column for single-column tables.
If NULL (default), automatically set to TRUE for single-column, FALSE for multi-column.}

\item{header_n_format}{Character string format for sample size in headers.
Use \code{{n}} as placeholder. Default: \code{"(n={n})"}.
Examples: \code{"(n={n})"}, \code{"\n(n={n})"}, \code{" ({n})"}.}

\item{cell_n_format}{Character string format for appending n to cell values when
they differ from header. Use \code{{n}} as placeholder. Default: \code{", n={n}"}.}

\item{indent_width}{Numeric, width of indentation for factor levels in units
(default = 2). Applied using flextable padding.}

\item{multiline_header}{Logical, whether to create multi-line headers with format
description. If TRUE, creates 3-line header: (1) Variable/Group name, (2) N = sample size,
(3) Format description. Default: FALSE.}

\item{footer_text}{Character string to add as footer row. If NULL (default), no footer is added.}

\item{table_width}{Numeric, table width as proportion of page (0-1). Default: 1.0.}

\item{table_layout}{Character, table layout. Options: "autofit" (default), "fixed", "auto".}

\item{theme}{Character, flextable theme. Options: "vanilla" (default), "booktabs", "alafoli", etc.
Set to NULL to skip theme application.}

\item{format_line_fontsize}{Numeric, font size for format description line (line 3) in
multi-line headers. Default: 9.}

\item{merge_variable_header}{Logical, whether to merge Variable column header across
all header rows in multi-line headers. Default: TRUE when multiline_header is TRUE.}

\item{bold_header}{Logical, whether to bold header rows. Default: TRUE.}

\item{bold_variable_column}{Logical, whether to bold all rows in the variable column.
Default: FALSE.}

\item{bold_subheaders}{Logical, whether to bold subheader rows (rows with NA statistics).
Default: TRUE.}

\item{...}{Additional arguments passed to \code{flextable::flextable()}}
}
\value{
A \code{flextable} object formatted for Word export.
}
\description{
Converts the output from \code{\link{specify_table1}} into a formatted
\code{flextable} object suitable for Word export. Handles sample sizes
in headers and per-cell n values when they differ from column headers.
}
\details{
For single-column tables:
\itemize{
\item Headers include sample size: "Statistic (n=100)"
\item An n column is included showing per-row sample sizes
}

For multi-column tables:
\itemize{
\item Each column header includes the column's total sample size
\item When a cell's sample size differs from the column header, it's appended
to the statistic (e.g., "45.2 (10.5), n=95" when header says n=100)
\item Subheaders are bolded by default
\item Factor levels are indented
}

When \code{multiline_header = TRUE}, creates a 3-line header structure:
\itemize{
\item Line 1: Variable/Group names
\item Line 2: N = sample sizes
\item Line 3: Format description (e.g., "\% (N) or Mean (SD)")
}
}
\examples{
\dontrun{
# Single-column table
table1 <- specify_table1(data, vars = c("age", "sex"))
ft <- table1_to_flextable(table1)

# Multi-column table with multi-line headers and custom formatting
table1_multi <- specify_table1(data, vars = c("age", "sex"), group = "group")
ft <- table1_to_flextable(
  table1_multi,
  multiline_header = TRUE,
  bold_header = TRUE,
  bold_subheaders = TRUE,
  bold_variable_column = FALSE,
  footer_text = "Note: Results presented as \% (count) for categorical variables..."
)

# Export to Word using document builder
library(table1)
doc <- table1_word_doc() |>
  implement_table1(table1_multi, caption = "Table 1: Characteristics")
save_table1_doc(doc, "table1.docx")
}

}
